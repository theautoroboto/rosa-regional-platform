# Maestro Agent Helm Chart Values (AWS Adaptation)
# Adapted from: https://github.com/Azure/ARO-HCP/tree/main/maestro/agent

maestroAgent:
  # Container image configuration
  image:
    registry: "quay.io"
    repository: "redhat-user-workloads/maestro-rhtap-tenant/maestro/maestro"
    tag: "latest"
    # digest: "sha256:..." # Use digest instead of tag for production
    pullPolicy: IfNotPresent

  # Deployment configuration
  deployment:
    replicas: 1  # Single agent per management cluster
    requests:
      cpu: "100m"
      memory: "256Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

  # Maestro agent configuration
  maestro:
    serviceAccount: "maestro-agent"
    consumerName: ""  # Populated from Terraform output (cluster ID)
    healthCheckBindPort: 8083
    glog_v: 10  # Verbose logging level

  # MQTT Broker configuration (AWS IoT Core)
  broker:
    # Endpoint and credentials from ASCP CSI driver
    type: "mqtt"
    configFile: "/config/config.yaml"
    endpoint: ""  # Populated from regional Terraform output (e.g., "xxx.iot.us-east-1.amazonaws.com")
    topicPrefix: "maestro/consumers"

  # ASCP CSI Driver configuration
  ascp:
    enabled: true
    mqttCertSecretName: ""  # Populated from regional Terraform (format: {cluster-id}/maestro/agent-mqtt-cert)

  # Tracing configuration
  tracing:
    enabled: false
    address: ""
    exporter: "none"

  # Metrics configuration
  metrics:
    enabled: true
    serviceMonitor:
      enabled: false  # Enable when Prometheus Operator is deployed
